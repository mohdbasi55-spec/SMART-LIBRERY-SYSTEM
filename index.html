<!DOCTYPE html>
<html>
<head>
<title>Smart Digital Library</title>
<script src="https://unpkg.com/html5-qrcode"></script>
<style>
body{margin:0;font-family:Arial;background:#f2f2f2}
header{background:#2c3e50;color:white;padding:15px;text-align:center}
#scanner,#dashboard{padding:20px}
.books{display:grid;grid-template-columns:repeat(auto-fit,minmax(120px,1fr));gap:10px}
.book{background:#3498db;color:white;padding:15px;border-radius:10px;cursor:pointer;text-align:center}
iframe,video,audio{width:100%;height:300px}
</style>
</head>

<body>
<header>
<h2>SMART DIGITAL LIBRARY</h2>
</header>

<div id="scanner">
<h3>Scan QR to Login</h3>
<div id="reader" style="width:300px;margin:auto;"></div>
</div>

<div id="dashboard" style="display:none;">
<h3>Books</h3>
<div class="books" id="bookshelf"></div>

<h3>Reader</h3>
<div id="viewer"></div>

<br>
<button onclick="location.reload()">Scan QR to Logout</button>
</div>

<script>
const books=[];
for(let i=1;i<=50;i++){
  books.push({name:"Book "+i,type:i%3});
}

function loadBooks(){
  let shelf=document.getElementById("bookshelf");
  shelf.innerHTML="";
  books.forEach(b=>{
    let d=document.createElement("div");
    d.className="book";
    d.innerText=b.name;
    d.onclick=()=>openBook(b);
    shelf.appendChild(d);
  });
}

function openBook(book){
  let v=document.getElementById("viewer");
  if(book.type==0){
    v.innerHTML="<iframe src='https://www.w3.org/WAI/ER/tests/xhtml/testfiles/resources/pdf/dummy.pdf'></iframe>";
  }else if(book.type==1){
    v.innerHTML="<video controls src='https://www.w3schools.com/html/mov_bbb.mp4'></video>";
  }else{
    v.innerHTML="<audio controls src='https://www.w3schools.com/html/horse.mp3'></audio>";
  }
}

function onScanSuccess(decodedText){
  console.log("Scanned:", decodedText);

  // URL irundhaalum login aagum
  if(decodedText.includes("http") || decodedText.length>0){
    document.getElementById("scanner").style.display="none";
    document.getElementById("dashboard").style.display="block";
    loadBooks();
    html5QrCode.stop();
  }
}

const html5QrCode=new Html5Qrcode("reader");
html5QrCode.start(
{facingMode:"environment"},
{fps:10,qrbox:250},
onScanSuccess
);
</script>
</body>
</html>
